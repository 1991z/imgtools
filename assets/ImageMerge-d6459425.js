import{_ as e,r as t,o as a,c as l,a as i,w as h,f as n,F as s,i as o,d as u,t as c,e as g,v as d}from"./index-62ba23d4.js";import{S as m}from"./SelectImage-a77911a7.js";const r=(e,t,a,l,i,h)=>new Promise(((n,s)=>{if((0===e.length||t>e.length)&&s("error"),t===e.length){const e="image/jpeg",l=a.toDataURL(e,h);let i=l.length-`data:${e};base64,`.length;i=parseInt(i-i/4);const s=Date.parse(new Date)/100+t;return void n({size:i,type:e,timeStamp:s,base64:l})}const o=new Image;o.onload=()=>{const s=document.createElement("canvas");if(null===a){s.width=o.width,s.height=o.height;s.getContext("2d").drawImage(o,0,0)}else{const e=a.getContext("2d").getImageData(0,0,a.width,a.height);if(l)if(i){const t=a.width/o.width*o.height;s.width=a.width,s.height=a.height+t;const l=s.getContext("2d");l.putImageData(e,0,0),l.drawImage(o,0,0,o.width,o.height,0,a.height,a.width,t)}else{const t=a.height/o.height*o.width;s.width=a.width+t,s.height=a.height;const l=s.getContext("2d");l.putImageData(e,0,0),l.drawImage(o,0,0,o.width,o.height,a.width,0,t,a.height)}else if(i){const t=a.width>o.width?a.width:o.width;s.width=t,s.height=a.height+o.height;const l=s.getContext("2d");l.putImageData(e,0,0),l.drawImage(o,0,a.height)}else{const t=a.height>o.height?a.height:o.height;s.width=a.width+o.width,s.height=t;const l=s.getContext("2d");l.putImageData(e,0,0),l.drawImage(o,a.width,0)}}n(r(e,t+1,s,l,i,h))},o.src=e[t].base64})),v={key:0},w={class:"maxBox"},p=["src"],f={class:"selBox"},b=["value"],I=["onClick"],k={key:0,class:"res"},x=["src"],C=e({__name:"ImageMerge",setup(e){const C=t([]);function S(e){C.value.push(e)}const y=t([]);function D(e){let t=parseInt(e.target.value);if(e.target.checked)y.value.push(t);else{let e=y.value;y.value=e.filter((e=>e!==t))}}const _=t(!0),j=t(!0),B=t({});function E(){let e=[];y.value.forEach((t=>{for(let a=0;a<C.value.length;a++){const l=C.value[a];if(l.timeStamp===t){e.push({...l});break}}})),0!==e.length&&r(e,0,null,j.value,_.value,.3).then((e=>{B.value=e}))}function U(){let{base64:e,type:t,timeStamp:a}=B.value,l=e.replace(`data:${t};base64,`,""),i=window.atob(l),h=new Uint8Array(i.length);for(let o=0;o<i.length;++o)h[o]=i.charCodeAt(o);let n=new Blob([h],{type:t}),s=document.createElement("a");s.href=URL.createObjectURL(n),s.download=a,s.target="_blank",s.click()}return(e,t)=>(a(),l(s,null,[i(m,{multiple:"",onGetImage:S},{default:h((()=>[C.value.length>0?(a(),l("div",v,[void 0!==B.value.base64?(a(),l("button",{key:0,class:"mr",onClick:t[0]||(t[0]=e=>C.value.push(B.value))},"结果作为素材")):u("",!0),n("button",{class:"stretch mr",onClick:t[1]||(t[1]=e=>j.value=!j.value)},c(j.value?"拉伸":"不拉伸"),1),n("button",{class:"mr",onClick:t[2]||(t[2]=e=>_.value=!_.value)},c(_.value?"竖向":"横向"),1),n("button",{onClick:E},"合并")])):u("",!0)])),_:1}),n("div",w,[(a(!0),l(s,null,o(C.value,(e=>(a(),l("div",{key:e.timeStamp,class:"imgBox"},[n("img",{src:e.base64},null,8,p),n("div",f,[n("input",{type:"checkbox",value:e.timeStamp,onChange:D},null,40,b),g(n("b",null,c(y.value.indexOf(e.timeStamp)+1),513),[[d,-1!==y.value.indexOf(e.timeStamp)]]),n("button",{onClick:t=>function(e){let t=[];C.value.forEach((a=>{a.timeStamp!==e&&t.push({...a})})),C.value=t;let a=y.value;y.value=a.filter((t=>t!==e))}(e.timeStamp)},"删除",8,I)])])))),128))]),void 0!==B.value.base64?(a(),l("div",k,[n("img",{src:B.value.base64,onClick:U},null,8,x)])):u("",!0)],64))}},[["__scopeId","data-v-770bc558"]]);export{C as default};
